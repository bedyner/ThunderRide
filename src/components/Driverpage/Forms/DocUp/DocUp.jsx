import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import './DocUp.css';

function FileGroup({ label, bulletPoints, accept, onFileSelect }) {
  const [file, setFile] = useState(null);

  const handleFileChange = (e) => {
    const f = e.target.files[0];
    if (!f) return;
    setFile(f);
    onFileSelect(true);
  };

  const acceptAttr = accept === 'pdf' ? '.pdf' : 'image/jpeg,image/png,image/webp';

  return (
    <div className="file-group">
      <h3 className="file-group-title">{label}</h3>
      <ul className="file-group-bullets">
        {bulletPoints.map((point, idx) => (
          <li key={idx}>{point}</li>
        ))}
      </ul>
      <label className="upload-button">
        อัปโหลดไฟล์
        <input type="file" accept={acceptAttr} onChange={handleFileChange} style={{ display: 'none' }} />
      </label>
      {file && <p className="file-selected">✓ เลือกไฟล์: {file.name}</p>}
    </div>
  );
}

export default function DocUp() {
  const navigate = useNavigate();
  const [status, setStatus] = useState({
    driverLicense: false,
    driverSelfie: false,
    publicLicense: false,
    nationalId: false,
    criminalRecord: false,
    vehicleRegistration: false,
    compulsoryInsurance: false,
    commercialInsurance: false,
    vehicleSticker: false,
  });

  const allUploaded = Object.values(status).every(Boolean);

  const handleNext = () => {
    if (!allUploaded) {
      navigate('/application-rejected');
      return;
    }
    navigate('/approval-pending'); // Final step - go to approval
  };

  return (
    <div className="docup-container">
      <h1 className="docup-title">เอกสารสำคัญ</h1>
      <p className="docup-subtitle">
        รับมอบการแสดกเอกสารที่ถูกต้องและรูปถ่ายคุณภาพพิเศษนั่น
      </p>
      <p className="docup-question">
        ต้องการความช่วยเหลือในการรับเอกสารหรือไม่? <span className="link-text">คลิกที่นี่</span>
      </p>

      <FileGroup
        label="ใบขับขี่"
        bulletPoints={[
          "กรุณาอัปโหลดรูปใบขับขี่ของคุณ ไฟล์สแกนเป็น PDF เป็นภาพสีสามารถใช้งานได้ รูปถ่ายของเอกสารจริงสามารถใช้งานได้ สำเนาใบขับขี่แบบขาวดำไม่สามารถใช้งานได้ ภาพหน้าจอจากแอปฯ DLT สามารถใช้งานได้ ใบขับขี่ที่ชำรุดเสียหาย ไม่สามารถใช้งานได้ ไม่เบลอหรือมีแสงสะท้อนบนบัตรจนไม่สามารถเห็นข้อมูลสำคัญ คนขับจะต้องมีอายุระหว่าง: 18-70 ปี คุณสามารถอัปโหลดใบขับขี่สาธารณะเข้ามาในช่องนี้เช่นกัน ภาพตัวอย่างเอกสารที่ถูกต้อง"
        ]}
        accept="pdf"
        onFileSelect={(ok) => setStatus(s => ({ ...s, driverLicense: ok }))}
      />

      <FileGroup
        label="รูปหน้าคนขับ หรือ ภาพถ่ายตนเอง"
        bulletPoints={[
          "กรุณาอัปโหลดรูปโปรไฟล์ของคุณ เป็นภาพบุคคลเดียวกัน กับรูปในบัตรประชาชน ใบขับขี่ส่วนบุคคล และใบขับขี่สาธารณะ มองเห็นดวงตาได้ชัดเจน ไม่สวมแว่นกันแดด และไม่มีเงาสะท้อนบังตาดำ ไม่สวมหมวกหรือหน้ากากปิดบังใบหน้า สามารถสวมใส่เครื่องนุ่งห่มทางศาสนาและแว่นสายตาได้ ไม่ถอดเสื้อ แต่งกายสุภาพ เป็นภาพสี และ ไม่มืดจนเกินไป ไม่มีบุคคลอื่นๆอยู่ในพื้นหลัง เป็นภาพต้นฉบับเท่านั้น ไม่ถ่ายหน้าจอมาจากแอพพลิเคชั่นอื่น ไม่มีตัวอักษรอยู่บนรูปภาพ  ไม่ใส่ฟิลเตอร์จนภาพไม่ชัดเจน"
        ]}
        accept="image"
        onFileSelect={(ok) => setStatus(s => ({ ...s, driverSelfie: ok }))}
      />

      <FileGroup
        label="ใบขับขี่สาธารณะ"
        bulletPoints={[
          "กรุณาอัปโหลดรูปใบขับขี่สาธารณะของคุณ ไฟล์สแกนเป็น PDF เป็นภาพสีสามารถใช้งานได้ รูปถ่ายของเอกสารจริงสามารถใช้งานได้ สำเนาใบขับขี่แบบขาวดำไม่สามารถใช้งานได้ ภาพหน้าจอจากแอปฯ DLT สามารถใช้งานได้ ใบขับขี่ที่ชำรุดเสียหาย ไม่สามารถใช้งานได้ ไม่เบลอหรือมีแสงสะท้อนบนบัตรจนไม่สามารถเห็นข้อมูลสำคัญต้องเป็นหนึ่งในประเภทใบขับขี่สาธารณะตามกฎหมายกำหนดเท่านั้น ใบอนุญาตขับรถจักรยานยนต์สาธารณะ ใบอนุญาตขับรถยนต์สาธารณะ ใบอนุญาตเป็นผู้ขับรถทุกประเภทชนิดที่ 2, 3, 4"

        ]}
        accept="pdf"
        onFileSelect={(ok) => setStatus(s => ({ ...s, publicLicense: ok }))}
      />

      <FileGroup
        label="บัตรประจำตัวประชาชน"
        bulletPoints={[
          "กรุณาอัปโหลดรูปโปรไฟล์ของคุณ เป็นภาพหน้าคนขับเดี่ยวกับบัตรประชาชนและใบขับขี่ ใบขับขี่ส่วนบุคคลและใบขับขี่สาธารณะบอกเพื่อเป็นการระบุตัวตนของคุณได้ใช้ตัดเอง ไม่สามารถเป็นคนอื่นได้ ไม่สามารถมีใช้รูปครอบครัวหรือภาพกลุ่มหรือภาพที่มีคนอื่นปรากฏ สามารถมีใช้รูปของคนทางการหาคนสำคัญได้ ไม่ปรากฏคนอื่นและไม่ปรากฏเด็ก และไม่ปรากฏสะท้อนบนกระจกไม่สามารถอัปโหลดรูปของคนอื่นหรือเด็กได้ ไม่ปรากฏวัตถุอื่นๆ เป็นภาพ และไม่ปรากฏเด็กเกินไปหรือคุณรูปภาพ ไม่ควรใช้ภาพที่เอาจากเอกสารอื่นๆ ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป"
        ]}
        accept="pdf"
        onFileSelect={(ok) => setStatus(s => ({ ...s, nationalId: ok }))}
      />

      <FileGroup
        label="เอกสารการตรวจสอบประวัติอาชญากรรม"
        bulletPoints={[
          "กรุณาอัปโหลดรูปเอกสารการตรวจสอบประวัติอาชญากรรมของคุณเห็นชื่อ-นามสกุลชัดเจน เห็นประวัติอาชญากรรมชัดเจน"
        ]}
        accept="pdf"
        onFileSelect={(ok) => setStatus(s => ({ ...s, criminalRecord: ok }))}
      />

      <FileGroup
        label="เอกสารการจดทะเบียนยานพาหนะ"
        bulletPoints={[
          "กรุณาอัปโหลดรูปโปรไฟล์ของคุณ เป็นภาพหน้าคนขับเดี่ยวกับบัตรประชาชนและใบขับขี่ ใบขับขี่ส่วนบุคคลและใบขับขี่สาธารณะบอกเพื่อเป็นการระบุตัวตนของคุณได้ใช้ตัดเอง ไม่สามารถเป็นคนอื่นได้ ไม่สามารถมีใช้รูปครอบครัวหรือภาพกลุ่มหรือภาพที่มีคนอื่นปรากฏ สามารถมีใช้รูปของคนทางการหาคนสำคัญได้ ไม่ปรากฏคนอื่นและไม่ปรากฏเด็ก และไม่ปรากฏสะท้อนบนกระจกไม่สามารถอัปโหลดรูปของคนอื่นหรือเด็กได้ ไม่ปรากฏวัตถุอื่นๆ เป็นภาพ และไม่ปรากฏเด็กเกินไปหรือคุณรูปภาพ ไม่ควรใช้ภาพที่เอาจากเอกสารอื่นๆ ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป"
        ]}
        accept="pdf"
        onFileSelect={(ok) => setStatus(s => ({ ...s, vehicleRegistration: ok }))}
      />

      <FileGroup
        label="ประกันภาคบังคับ (พรบ.)"
        bulletPoints={[
          "กรุณาอัปโหลดรูปโปรไฟล์ของคุณ เป็นภาพหน้าคนขับเดี่ยวกับบัตรประชาชนและใบขับขี่ ใบขับขี่ส่วนบุคคลและใบขับขี่สาธารณะบอกเพื่อเป็นการระบุตัวตนของคุณได้ใช้ตัดเอง ไม่สามารถเป็นคนอื่นได้ ไม่สามารถมีใช้รูปครอบครัวหรือภาพกลุ่มหรือภาพที่มีคนอื่นปรากฏ สามารถมีใช้รูปของคนทางการหาคนสำคัญได้ ไม่ปรากฏคนอื่นและไม่ปรากฏเด็ก และไม่ปรากฏสะท้อนบนกระจกไม่สามารถอัปโหลดรูปของคนอื่นหรือเด็กได้ ไม่ปรากฏวัตถุอื่นๆ เป็นภาพ และไม่ปรากฏเด็กเกินไปหรือคุณรูปภาพ ไม่ควรใช้ภาพที่เอาจากเอกสารอื่นๆ ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป ไม่ปรากฏวัตถุอื่นๆ เป็นภาพเฟดเดอร์เกินไป"
        ]}
        accept="pdf"
        onFileSelect={(ok) => setStatus(s => ({ ...s, compulsoryInsurance: ok }))}
      />

      <FileGroup
        label="ประกันรถยนต์เชิงพาณิชย์"
        bulletPoints={[
          "สำหรับรถยนต์เท่านั้น กรุณาอัปโหลดเอกสารประกันรถยนต์เชิงพาณิชย์ของคุณ ต้องเห็นข้อมูลชัดเจน ช่องการใช้รถต้องระบุว่ารถยนต์รับจ้างผ่านระบบอิเล็กทรอนิกส์ ใช้เพื่อการพาณิชย์หรือรถรับจ้างสาธารณะ" 
        ]}
        accept="pdf"
        onFileSelect={(ok) => setStatus(s => ({ ...s, commercialInsurance: ok }))}
      />

      <FileGroup
        label="สติ๊กเกอร์รถยนต์รับจ้างผ่าน
        ระบบอิเล็กทรอนิกส์"
        bulletPoints={[
          "สำหรับรถยนต์ 4 ล้อเท่านั้น กรุณาอัปโหลดรูปสติ๊กเกอร์รถยนต์รับจ้างผ่านระบบอิเล็กทรอนิกส์คุณ เป็นรูปสี เห็นข้อมูลชัดเจน สติ๊กเกอร์ยังไม่หมดอายุ"
        ]}
        accept="pdf"
        onFileSelect={(ok) => setStatus(s => ({ ...s, vehicleSticker: ok }))}
      />

        <button type="button" className="btn-primary" onClick={handleNext}>Next</button>
    </div>
  );
}
